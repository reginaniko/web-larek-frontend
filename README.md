# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


Описание данных
IProductItem
Интерфейс, представляющий информацию о продукте, включает следующие поля:
id: string — уникальный идентификатор продукта.
description?: string — описание продукта (необязательное поле).
image?: string — ссылка на изображение продукта (необязательное поле).
title: string — название продукта.
category?: string — категория, к которой относится продукт (необязательное поле).
price: number — цена продукта.

IAppData
Интерфейс класса бизнес-логики приложения. Определяет структуру состояния для управления продуктами и заказами, содержащую:
gallery: IProductItem[] — массив объектов продуктов, доступных в галерее.
cart: string[] — массив идентификаторов продуктов, добавленных в корзину.
preview: string | null — идентификатор продукта, выбранного для предпросмотра, или null, если ничего не выбрано.
order: IOrder | null — объект с информацией о заказе, или null, если заказ не оформлен.
formErrors: FormErrors - объект, содержащий ошибки валидации для форм.

IPaymentForm
Интерфейс для данных формы способа оплаты заказа и адреса доставки, включающий:
payment: ‘online’|’upon receipt’— выбранный способ оплаты.
address: string — адрес доставки.

IContactsForm
Интерфейс для формы оформления контактных данных для заказа, включающий:
email: string — адрес электронной почты покупателя.
phone: string — телефон покупателя.

IOrder
Интерфейс, объединяющий свойства из IPaymentForm и IContactsForm интерфейсов, а также имеет следующие дополнительные поля:
items: string[] — массив идентификаторов продуктов в заказе.
total: number — общая стоимость заказа.

IOrderResult
Интерфейс, описывающий результат заказа:
id: string — идентификатор заказа.
total: number — общая стоимость заказа.

FormErrors
Тип, представляющий ошибки формы, где ключи соответствуют полям заказа, а значения — ошибки этих полей.

Архитектура проекта
Проект выстроен в логике MVP (Model-View-Presenter) паттерна, который разделяет ответственность между тремя основными компонентами: Model, View и Presenter.
Model: управляет данными приложения и бизнес-логикой, предоставляя интерфейс для получения и обновления данных.
View: отвечает за отображение данных пользователю и прием ввода от пользователя, но не содержит логики обработки данных.
Presenter: посредник между Model и View, который получает данные из Model, форматирует их для отображения и обновляет View. Также обрабатывает пользовательский ввод, внося изменения в Model. (Реализован непосредственно в файле index.ts)

Классы модели данных
Базовый класс Model
Класс Model представляет собой абстрактный базовый класс, который служит основой для всех моделей данных в приложении. Он предоставляет функциональность для инициализации данных модели и управления событиями с помощью объекта IEvents.

constructor(container: HTMLElement, events: IEvents) — cоздает новый экземпляр класса Model, инициализируя его частичными данными и объектом событий.
Метод emitChanges(генерирует событие с указанным именем и необязательным payload) и isModel(проверяет, является ли переданный объект экземпляром класса Model)
ItemData
Класс для управления товарами.
constructor(container: HTMLElement, events: IEvents) — создает новый экземпляр класса ItemData, инициализируя его частичными данными и объектом событий.

AppData
Класс-модель для управления взаимодействием данных товаров и корзины, а также заказов. Наследуется от класса Model и включает свойства и методы для управления корзиной, галереей, состоянием загрузки, информацией о заказе и предварительным просмотром товаров.
Свойства: 
gallery: IProductItem[] - Массив товаров, доступных в галерее.
cart: string[] - Массив товаров, которые в настоящее время находятся в корзине.
order: IOrder - Объект, представляющий информацию о заказе, включая способ оплаты, адрес, email, телефон.
preview: string | null - Строка, представляющая ID текущего товара для предварительного просмотра, или null, если товар не выбран.
formErrors: FormErrors - Объект, содержащий ошибки валидации для форм.

Методы: 
setGallery - Устанавливает галерею с новым списком товаров.
setPreview - Устанавливает товар для предварительного просмотра по его ID.
getProducts - Возвращает текущий список товаров в галерее.
getCart - Возвращает текущий список товаров в корзине.
setOrderField и setContactsField - Устанавливают конкретное поле в форме заказа и проверяют его.
validateOrder и validateContacts - Проверяют поля формы заказа и генерируют события ошибок формы, если есть ошибки валидации.
addToCart - Добавляет товар в корзину.
getTotalPrice - Вычисляет и возвращает общую стоимость товаров в корзине.

Классы слоя представления
Component
Абстрактный класс для наследования компонентами, которые будут реализовывать конкретную функциональность интерфейса.
constructor(container: HTMLElement) — конструктор, принимающий контейнер для рендеринга компонента.
toggleClass(element: HTMLElement, className: string, force?: boolean) — переключает класс элемента.
setText(element: HTMLElement, value: unknown) — устанавливает текстовое содержимое элемента.
setDisabled(element: HTMLElement, state: boolean) — устанавливает состояние блокировки элемента.
setImage(element: HTMLImageElement, src: string, alt?: string) — устанавливает изображение и альтернативный текст.
render(data?: Partial<T>): HTMLElement — рендерит компонент, принимая данные и возвращая корневой DOM-элемент.

Modal
Компонент модального окна.
constructor(container: HTMLElement, events: IEvents) — конструктор, принимающий контейнер и объект событий.
Методы для управления содержимым и состоянием модального окна: set content, open, order, orderContacts, close, render.
Класс PageView
Компонент страницы галереи товаров.
constructor(container: HTMLElement, events: IEvents) — конструктор, принимающий контейнер и объект событий.
Методы для управления отображением галереи товаров, страницы и кнопки перехода в корзину товаров.

Класс ItemView
Компоненты карточки товара в зависимости от стиля отображения товара на разных экранах приложения.
constructor(container: HTMLElement, events: IEvents) — конструктор, принимающий контейнер и объект событий.
Методы для установки различных свойств карточки: id, title, image, category, inCart, price, description.

CartView
Компонент корзины товаров.
constructor(container: HTMLElement, events: IEvents) — конструктор, принимающий контейнер и объект событий.
Методы для управления корзиной: set items, set button, set total.

Классы OrderView и ContactsView
Компоненты форм заказа.
constructor(container: HTMLFormElement, events: IEvents) — конструктор, принимающий контейнер формы и объект событий.
Методы для управления состоянием и отображением формы: set valid, set errors, render.
OrderSuccessView
Компонент, отображающий успешное завершение заказа и количество списанных синапсов.
constructor(container: HTMLElement, events: IEvents, total: number) — конструктор, принимающий контейнер, события и общую стоимость заказа.
Методы и свойства для отображения и управления компонентом: total, onClick.
Описание событий
Для работы с событиями используется EventEmitter, реализуя паттерн наблюдателя.Этот класс позволяет управлять подпиской на события, их генерацией и обработкой, уведомляя различные компоненты о произошедших изменениях или действиях. Это позволяет компонентам взаимодействовать друг с другом, не будучи напрямую связанными.В реализуемой MVP архитектуре, при изменениях в слое данных и/или в слое представления генерируются события, уведомляющие слой презентера о произошедших изменениях. 
События изменения данных
items: changed — изменение элементов в каталоге.
preview: changed — изменение предпросмотра товара.
cart: update — обновление содержимого корзины.
cart: remove — удаление товара из корзины.
cart: clear — очистка корзины.
order: submit — отправка формы заказа.
contacts: submit — отправка контактных данных.
formErrors: changed — изменение ошибок валидации формы.
payment: changed — изменение метода оплаты.

События компонентов представления
modal: open — открытие модального окна.
modal: close — закрытие модального окна.
cart: open — открытие корзины.
orderPayment: open — открытие формы заказа.
orderContacts: open — открытие формы для ввода контактных данных.